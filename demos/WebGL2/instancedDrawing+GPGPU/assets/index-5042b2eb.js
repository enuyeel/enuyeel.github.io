(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Te=1e-6,le=typeof Float32Array<"u"?Float32Array:Array,mn=Math.PI/180;function gn(t){return t*mn}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function It(){var t=new le(16);return le!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function pn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _n(t,e,n,r,i){var o=1/Math.tan(e/2),s;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(s=1/(r-i),t[10]=(i+r)*s,t[14]=2*i*r*s):(t[10]=-1,t[14]=-2*r),t}var bn=_n;function vn(t,e,n,r){var i,o,s,l,c,m,p,h,f,g,_=e[0],b=e[1],E=e[2],A=r[0],C=r[1],x=r[2],R=n[0],I=n[1],Ke=n[2];return Math.abs(_-R)<Te&&Math.abs(b-I)<Te&&Math.abs(E-Ke)<Te?pn(t):(p=_-R,h=b-I,f=E-Ke,g=1/Math.hypot(p,h,f),p*=g,h*=g,f*=g,i=C*f-x*h,o=x*p-A*f,s=A*h-C*p,g=Math.hypot(i,o,s),g?(g=1/g,i*=g,o*=g,s*=g):(i=0,o=0,s=0),l=h*s-f*o,c=f*i-p*s,m=p*o-h*i,g=Math.hypot(l,c,m),g?(g=1/g,l*=g,c*=g,m*=g):(l=0,c=0,m=0),t[0]=i,t[1]=l,t[2]=p,t[3]=0,t[4]=o,t[5]=c,t[6]=h,t[7]=0,t[8]=s,t[9]=m,t[10]=f,t[11]=0,t[12]=-(i*_+o*b+s*E),t[13]=-(l*_+c*b+m*E),t[14]=-(p*_+h*b+f*E),t[15]=1,t)}function Bt(){var t=new le(3);return le!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function yn(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function He(t,e,n){var r=new le(3);return r[0]=t,r[1]=e,r[2]=n,r}var wn=yn;(function(){var t=Bt();return function(e,n,r,i,o,s){var l,c;for(n||(n=3),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,l=r;l<c;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],o(t,t,s),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}})();function ue(t){return ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(t)}function En(t,e){if(ue(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ue(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xn(t){var e=En(t,"string");return ue(e)==="symbol"?e:String(e)}function v(t,e,n){return e=xn(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function An(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;const l=t.POSITION?t.POSITION.value:[],c=l&&l.length;for(let m=0;m<c;m+=3){const p=l[m],h=l[m+1],f=l[m+2];e=p<e?p:e,n=h<n?h:n,r=f<r?f:r,i=p>i?p:i,o=h>o?h:o,s=f>s?f:s}return[[e,n,r],[i,o,s]]}function Sn(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class ${constructor(e,n){v(this,"fields",void 0),v(this,"metadata",void 0),Sn(Array.isArray(e)),Tn(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const s of r)e[s]=!0;const o=this.fields.filter(s=>e[s.name]);return new $(o,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n.map(o=>this.fields[o]).filter(Boolean);return new $(i,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof $){const s=e;n=s.fields,r=qe(qe(new Map,this.metadata),s.metadata)}else n=e;const i=Object.create(null);for(const s of this.fields)i[s.name]=s;for(const s of n)i[s.name]=s;const o=Object.values(i);return new $(o,r)}}function Tn(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function qe(t,e){return new Map([...t||new Map,...e||new Map])}class re{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;v(this,"name",void 0),v(this,"type",void 0),v(this,"nullable",void 0),v(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new re(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let T;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"})(T||(T={}));let Pt,Dt,Mt;class Ge{static isNull(e){return e&&e.typeId===T.Null}static isInt(e){return e&&e.typeId===T.Int}static isFloat(e){return e&&e.typeId===T.Float}static isBinary(e){return e&&e.typeId===T.Binary}static isUtf8(e){return e&&e.typeId===T.Utf8}static isBool(e){return e&&e.typeId===T.Bool}static isDecimal(e){return e&&e.typeId===T.Decimal}static isDate(e){return e&&e.typeId===T.Date}static isTime(e){return e&&e.typeId===T.Time}static isTimestamp(e){return e&&e.typeId===T.Timestamp}static isInterval(e){return e&&e.typeId===T.Interval}static isList(e){return e&&e.typeId===T.List}static isStruct(e){return e&&e.typeId===T.Struct}static isUnion(e){return e&&e.typeId===T.Union}static isFixedSizeBinary(e){return e&&e.typeId===T.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===T.FixedSizeList}static isMap(e){return e&&e.typeId===T.Map}static isDictionary(e){return e&&e.typeId===T.Dictionary}get typeId(){return T.NONE}compareTo(e){return this===e}}Pt=Symbol.toStringTag;class J extends Ge{constructor(e,n){super(),v(this,"isSigned",void 0),v(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return T.Int}get[Pt](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class Cn extends J{constructor(){super(!0,8)}}class Ln extends J{constructor(){super(!0,16)}}class Rn extends J{constructor(){super(!0,32)}}class kn extends J{constructor(){super(!1,8)}}class On extends J{constructor(){super(!1,16)}}class Fn extends J{constructor(){super(!1,32)}}const Ut={HALF:16,SINGLE:32,DOUBLE:64};Dt=Symbol.toStringTag;class Nt extends Ge{constructor(e){super(),v(this,"precision",void 0),this.precision=e}get typeId(){return T.Float}get[Dt](){return"Float"}toString(){return"Float".concat(this.precision)}}class In extends Nt{constructor(){super(Ut.SINGLE)}}class Bn extends Nt{constructor(){super(Ut.DOUBLE)}}Mt=Symbol.toStringTag;class Pn extends Ge{constructor(e,n){super(),v(this,"listSize",void 0),v(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return T.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Mt](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function Dn(t){switch(t.constructor){case Int8Array:return new Cn;case Uint8Array:return new kn;case Int16Array:return new Ln;case Uint16Array:return new On;case Int32Array:return new Rn;case Uint32Array:return new Fn;case Float32Array:return new In;case Float64Array:return new Bn;default:throw new Error("array type not supported")}}const Mn=/^[og]\s*(.+)?/,Un=/^mtllib /,Nn=/^usemtl /;class je{constructor(e){let{index:n,name:r="",mtllib:i,smooth:o,groupStart:s}=e;this.index=n,this.name=r,this.mtllib=i,this.smooth=o,this.groupStart=s,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new je({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class Vn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);const i=new je({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0});return this.materials.push(i),i}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class zn{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new Vn(e),this.object.fromDeclaration=n,r&&r.name&&typeof r.clone=="function"){const i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseNormalIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseUVIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/2)*2}addVertex(e,n,r){const i=this.vertices,o=this.object.geometry.vertices;o.push(i[e+0],i[e+1],i[e+2]),o.push(i[n+0],i[n+1],i[n+2]),o.push(i[r+0],i[r+1],i[r+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,r){const i=this.normals,o=this.object.geometry.normals;o.push(i[e+0],i[e+1],i[e+2]),o.push(i[n+0],i[n+1],i[n+2]),o.push(i[r+0],i[r+1],i[r+2])}addColor(e,n,r){const i=this.colors,o=this.object.geometry.colors;o.push(i[e+0],i[e+1],i[e+2]),o.push(i[n+0],i[n+1],i[n+2]),o.push(i[r+0],i[r+1],i[r+2])}addUV(e,n,r){const i=this.uvs,o=this.object.geometry.uvs;o.push(i[e+0],i[e+1]),o.push(i[n+0],i[n+1]),o.push(i[r+0],i[r+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,r,i,o,s,l,c,m){const p=this.vertices.length;let h=this.parseVertexIndex(e,p),f=this.parseVertexIndex(n,p),g=this.parseVertexIndex(r,p);if(this.addVertex(h,f,g),i!==void 0&&i!==""){const _=this.uvs.length;h=this.parseUVIndex(i,_),f=this.parseUVIndex(o,_),g=this.parseUVIndex(s,_),this.addUV(h,f,g)}if(l!==void 0&&l!==""){const _=this.normals.length;h=this.parseNormalIndex(l,_),f=l===c?h:this.parseNormalIndex(c,_),g=l===m?h:this.parseNormalIndex(m,_),this.addNormal(h,f,g)}this.colors.length>0&&this.addColor(h,f,g)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const r of e)this.addVertexPoint(this.parseVertexIndex(r,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const r=this.vertices.length,i=this.uvs.length;for(const o of e)this.addVertexLine(this.parseVertexIndex(o,r));for(const o of n)this.addUVLine(this.parseUVIndex(o,i))}}function Hn(t){const e=new zn;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let r="",i="",o=0,s=[];const l=typeof"".trimLeft=="function";for(let p=0,h=n.length;p<h;p++)if(r=n[p],r=l?r.trimLeft():r.trim(),o=r.length,o!==0&&(i=r.charAt(0),i!=="#"))if(i==="v"){const f=r.split(/\s+/);switch(f[0]){case"v":e.vertices.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),f.length===8&&e.colors.push(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6]));break;case"vn":e.normals.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":e.uvs.push(parseFloat(f[1]),parseFloat(f[2]));break}}else if(i==="f"){const g=r.substr(1).trim().split(/\s+/),_=[];for(let E=0,A=g.length;E<A;E++){const C=g[E];if(C.length>0){const x=C.split("/");_.push(x)}}const b=_[0];for(let E=1,A=_.length-1;E<A;E++){const C=_[E],x=_[E+1];e.addFace(b[0],C[0],x[0],b[1],C[1],x[1],b[2],C[2],x[2])}}else if(i==="l"){const f=r.substring(1).trim().split(" ");let g;const _=[];if(r.indexOf("/")===-1)g=f;else{g=[];for(let b=0,E=f.length;b<E;b++){const A=f[b].split("/");A[0]!==""&&g.push(A[0]),A[1]!==""&&_.push(A[1])}}e.addLineGeometry(g,_)}else if(i==="p"){const g=r.substr(1).trim().split(" ");e.addPointGeometry(g)}else if((s=Mn.exec(r))!==null){const f=(" "+s[0].substr(1).trim()).substr(1);e.startObject(f)}else if(Nn.test(r))e.object.startMaterial(r.substring(7).trim(),e.materialLibraries);else if(Un.test(r))e.materialLibraries.push(r.substring(7).trim());else if(i==="s"){if(s=r.split(" "),s.length>1){const g=s[1].trim().toLowerCase();e.object.smooth=g!=="0"&&g!=="off"}else e.object.smooth=!0;const f=e.object.currentMaterial();f&&(f.smooth=e.object.smooth)}else{if(r==="\0")continue;throw new Error('Unexpected line: "'.concat(r,'"'))}e.finalize();const c=[],m=[];for(const p of e.objects){const{geometry:h}=p;if(h.vertices.length===0)continue;const f={header:{vertexCount:h.vertices.length/3},attributes:{}};switch(h.type){case"Points":f.mode=0;break;case"Line":f.mode=1;break;default:f.mode=4;break}f.attributes.POSITION={value:new Float32Array(h.vertices),size:3},h.normals.length>0&&(f.attributes.NORMAL={value:new Float32Array(h.normals),size:3}),h.colors.length>0&&(f.attributes.COLOR_0={value:new Float32Array(h.colors),size:3}),h.uvs.length>0&&(f.attributes.TEXCOORD_0={value:new Float32Array(h.uvs),size:2}),f.materials=[];for(const g of p.materials){const _={name:g.name,flatShading:!g.smooth};f.materials.push(_),m.push(_)}f.name=p.name,c.push(f)}return{meshes:c,materials:m}}function Gn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const i in e)n=n||new Map,i!=="value"&&n.set(i,JSON.stringify(e[i]));const r=[];for(const i in t){const o=t[i],s=jn(i,o);r.push(s)}return new $(r,n)}function jn(t,e){const n=new Map;for(const o in e)o!=="value"&&n.set(o,JSON.stringify(e[o]));const r=Dn(e.value);return!("size"in e)||e.size===1?new re(t,r,!1,n):new re(t,new Pn(e.size,new re("value",r)),!1,n)}function Ze(t,e){const{meshes:n}=Hn(t),r=n.reduce((l,c)=>l+c.header.vertexCount,0),i=Wn(n,r),o={vertexCount:r,boundingBox:An(i)},s=Gn(i,{mode:4,boundingBox:o.boundingBox});return{loaderData:{header:{}},schema:s,header:o,mode:4,attributes:i}}function Wn(t,e){const n=new Float32Array(e*3);let r,i,o,s=0;for(const c of t){const{POSITION:m,NORMAL:p,COLOR_0:h,TEXCOORD_0:f}=c.attributes;n.set(m.value,s*3),p&&(r=r||new Float32Array(e*3),r.set(p.value,s*3)),h&&(i=i||new Float32Array(e*3),i.set(h.value,s*3)),f&&(o=o||new Float32Array(e*2),o.set(f.value,s*2)),s+=m.value.length/3}const l={};return l.POSITION={value:n,size:3},r&&(l.NORMAL={value:r,size:3}),i&&(l.COLOR_0={value:i,size:3}),o&&(l.TEXCOORD_0={value:o,size:2}),l}const Xn="3.3.3",$n={name:"OBJ",id:"obj",module:"obj",version:Xn,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:Yn,options:{obj:{}}};function Yn(t){return t[0]==="v"}const Jn={...$n,parse:async(t,e)=>Ze(new TextDecoder().decode(t)),parseTextSync:(t,e)=>Ze(t)};function et(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const Vt=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),tt=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);tt&&parseFloat(tt[1]);const Qn="3.3.3";function D(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const pe=typeof process!="object"||String(process)!=="[object process]"||process.browser,Kn=typeof window<"u"&&typeof window.orientation<"u",nt=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);nt&&parseFloat(nt[1]);class qn{constructor(e,n){v(this,"name",void 0),v(this,"workerThread",void 0),v(this,"isRunning",!0),v(this,"result",void 0),v(this,"_resolve",()=>{}),v(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){D(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){D(this.isRunning),this.isRunning=!1,this._reject(e)}}let Ce=class{terminate(){}};const Le=new Map;function Zn(t){D(t.source&&!t.url||!t.source&&t.url);let e=Le.get(t.source||t.url);return e||(t.url&&(e=er(t.url),Le.set(t.url,e)),t.source&&(e=zt(t.source),Le.set(t.source,e))),D(e),e}function er(t){if(!t.startsWith("http"))return t;const e=tr(t);return zt(e)}function zt(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function tr(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function Ht(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(rt(t))r.add(t);else if(rt(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)Ht(t[i],e,r)}}return n===void 0?Array.from(r):[]}function rt(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Re=()=>{};class Be{static isSupported(){return typeof Worker<"u"&&pe||typeof Ce<"u"&&!pe}constructor(e){v(this,"name",void 0),v(this,"source",void 0),v(this,"url",void 0),v(this,"terminated",!1),v(this,"worker",void 0),v(this,"onMessage",void 0),v(this,"onError",void 0),v(this,"_loadableURL","");const{name:n,source:r,url:i}=e;D(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=Re,this.onError=o=>console.log(o),this.worker=pe?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Re,this.onError=Re,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||Ht(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=Zn({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Ce(r,{eval:!1})}else if(this.source)e=new Ce(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class nr{static isSupported(){return Be.isSupported()}constructor(e){v(this,"name","unnamed"),v(this,"source",void 0),v(this,"url",void 0),v(this,"maxConcurrency",1),v(this,"maxMobileConcurrency",1),v(this,"onDebug",()=>{}),v(this,"reuseWorkers",!0),v(this,"props",{}),v(this,"jobQueue",[]),v(this,"idleQueue",[]),v(this,"count",0),v(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(o,s,l)=>o.done(l),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(o,s)=>o.error(s);const i=new Promise(o=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:o}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new qn(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Be({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Kn?this.maxMobileConcurrency:this.maxConcurrency}}const rr={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class P{static isSupported(){return Be.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return P._workerFarm=P._workerFarm||new P({}),P._workerFarm.setProps(e),P._workerFarm}constructor(e){v(this,"props",void 0),v(this,"workerPools",new Map),this.props={...rr},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let o=this.workerPools.get(n);return o||(o=new nr({name:n,source:r,url:i}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}v(P,"_workerFarm",void 0);const ir="latest";function or(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let o=t.version;o==="latest"&&(o=ir);const s=o?"@".concat(o):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(s,"/dist/").concat(r)}return D(i),i}function sr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qn;D(t,"no worker provided");const n=t.version;return!(!e||!n)}function ar(t,e){return!P.isSupported()||!pe&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function lr(t,e,n,r,i){const o=t.id,s=or(t,n),c=P.getWorkerFarm(n).getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const m=await c.startJob("process-on-worker",ur.bind(null,i));return m.postMessage("process",{input:e,options:n,context:r}),await(await m.result).result}async function ur(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:o,options:s}=r;try{const l=await t(o,s);e.postMessage("done",{id:i,result:l})}catch(l){const c=l instanceof Error?l.message:"unknown error";e.postMessage("error",{id:i,error:c})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function cr(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}function dr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(l=>l instanceof ArrayBuffer?new Uint8Array(l):l),i=r.reduce((l,c)=>l+c.byteLength,0),o=new Uint8Array(i);let s=0;for(const l of r)o.set(l,s),s+=l.byteLength;return o.buffer}async function fr(t){const e=[];for await(const n of t)e.push(n);return dr(...e)}let hr="";const it={};function mr(t){for(const e in it)if(t.startsWith(e)){const n=it[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(hr).concat(t)),t}function gr(t){return t&&typeof t=="object"&&t.isBuffer}function Gt(t){if(gr(t))return(void 0)(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function pr(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}const _r=t=>typeof t=="boolean",ie=t=>typeof t=="function",de=t=>t!==null&&typeof t=="object",ot=t=>de(t)&&t.constructor==={}.constructor,br=t=>t&&typeof t[Symbol.iterator]=="function",vr=t=>t&&typeof t[Symbol.asyncIterator]=="function",Q=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,K=t=>typeof Blob<"u"&&t instanceof Blob,yr=t=>t&&typeof t=="object"&&t.isBuffer,wr=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||de(t)&&ie(t.tee)&&ie(t.cancel)&&ie(t.getReader),Er=t=>de(t)&&ie(t.read)&&ie(t.pipe)&&_r(t.readable),jt=t=>wr(t)||Er(t),xr=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Ar=/^([-\w.]+\/[-\w.+]+)/;function Sr(t){const e=Ar.exec(t);return e?e[1]:t}function st(t){const e=xr.exec(t);return e?e[1]:""}const Tr=/\?.*/;function Se(t){if(Q(t)){const e=ke(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:Sr(n)||st(e)}}return K(t)?{url:ke(t.name||""),type:t.type||""}:typeof t=="string"?{url:ke(t),type:st(t)}:{url:"",type:""}}function Cr(t){return Q(t)?t.headers["content-length"]||-1:K(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function ke(t){return t.replace(Tr,"")}async function Wt(t){if(Q(t))return t;const e={},n=Cr(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:i}=Se(t);i&&(e["content-type"]=i);const o=await kr(t);o&&(e["x-first-bytes"]=o),typeof t=="string"&&(t=new TextEncoder().encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:r}),s}async function Lr(t){if(!t.ok){const e=await Rr(t);throw new Error(e)}}async function Rr(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function kr(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=o=>{var s;return r(o==null||(s=o.target)===null||s===void 0?void 0:s.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=Or(n);return"data:base64,".concat(r)}return null}function Or(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function at(t,e){if(typeof t=="string"){t=mr(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await Wt(t)}function Fr(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function fe(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||Fr()}const _e={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},he=_e.window||_e.self||_e.global,q=_e.process||{},Xt=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";fe();function Ir(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class Br{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";v(this,"storage",void 0),v(this,"id",void 0),v(this,"config",void 0),this.storage=Ir(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function Pr(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function Dr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Oe(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,s=t.height*n,l=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),l]}let ye;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(ye||(ye={}));function lt(t){return typeof t=="string"?ye[t.toUpperCase()]||ye.WHITE:t}function Mr(t,e,n){return!fe&&typeof t=="string"&&(e&&(e=lt(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=lt(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function Ur(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(o=>i===o)||(t[i]=t[i].bind(t)))}function we(t,e){if(!t)throw new Error(e||"Assertion failed")}function G(){let t;if(fe&&"performance"in he){var e,n;t=he==null||(e=he.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in q){var r;const i=q==null||(r=q.hrtime)===null||r===void 0?void 0:r.call(q);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const j={debug:fe&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Nr={enabled:!0,level:0};function k(){}const ut={},ct={once:!0};class We{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};v(this,"id",void 0),v(this,"VERSION",Xt),v(this,"_startTs",G()),v(this,"_deltaTs",G()),v(this,"_storage",void 0),v(this,"userData",{}),v(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new Br("__probe-".concat(this.id,"__"),Nr),this.timeStamp("".concat(this.id," started")),Ur(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((G()-this._startTs).toPrecision(10))}getDelta(){return Number((G()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){we(e,n)}warn(e){return this._getLogFunction(0,e,j.warn,arguments,ct)}error(e){return this._getLogFunction(0,e,j.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,j.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,j.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return this._getLogFunction(e,n,j.debug||j.info,arguments,ct)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||k,r&&[r],{tag:Gr(n)}):k}image(e){let{logLevel:n,priority:r,image:i,message:o="",scale:s=1}=e;return this._shouldLog(n||r)?fe?Hr({image:i,message:o,scale:s}):zr():k}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||k)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=dt({logLevel:e,message:n,opts:r}),{collapsed:o}=r;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||k)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=$t(e)}_getLogFunction(e,n,r,i,o){if(this._shouldLog(e)){o=dt({logLevel:e,message:n,args:i,opts:o}),r=r||o.method,we(r),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=G();const s=o.tag||o.message;if(o.once)if(!ut[s])ut[s]=G();else return k;return n=Vr(this.id,o.message,o),r.bind(console,n,...o.args)}return k}}v(We,"VERSION",Xt);function $t(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return we(Number.isFinite(e)&&e>=0),e}function dt(t){const{logLevel:e,message:n}=t;t.logLevel=$t(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return we(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function Vr(t,e,n){if(typeof e=="string"){const r=n.time?Dr(Pr(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=Mr(e,n.color,n.background)}return e}function zr(t){return console.warn("removed"),k}function Hr(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const o=new Image;return o.onload=()=>{const s=Oe(o,n,r);console.log(...s)},o.src=e,k}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Oe(e,n,r)),k;if(i.toLowerCase()==="canvas"){const o=new Image;return o.onload=()=>console.log(...Oe(o,n,r)),o.src=e.toDataURL(),k}return k}function Gr(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const ft=new We({id:"loaders.gl"});class jr{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class Wr{constructor(){v(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const Yt={fetch:null,mimeType:void 0,nothrow:!1,log:new Wr,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Vt,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Xr={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Jt(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const Qt=()=>{const t=Jt();return t.globalOptions=t.globalOptions||{...Yt},t.globalOptions};function $r(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],Yr(t,n),Qr(e,t,r)}function Kt(t,e){const n=Qt(),r=t||n;return typeof r.fetch=="function"?r.fetch:de(r.fetch)?i=>at(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:at}function Yr(t,e){ht(t,null,Yt,Xr,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};ht(r,n.id,i,o,e)}}function ht(t,e,n,r,i){const o=e||"Top level",s=e?"".concat(e,"."):"";for(const l in t){const c=!e&&de(t[l]),m=l==="baseUri"&&!e,p=l==="workerUrl"&&e;if(!(l in n)&&!m&&!p){if(l in r)ft.warn("".concat(o," loader option '").concat(s).concat(l,"' no longer supported, use '").concat(r[l],"'"))();else if(!c){const h=Jr(l,i);ft.warn("".concat(o," loader option '").concat(s).concat(l,"' not recognized. ").concat(h))()}}}}function Jr(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const o in i.options){if(t===o)return"Did you mean '".concat(i.id,".").concat(o,"'?");const s=o.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(o,"'?"))}return r}function Qr(t,e,n){const i={...t.options||{}};return Kr(i,n),i.log===null&&(i.log=new jr),mt(i,Qt()),mt(i,e),i}function mt(t,e){for(const n in e)if(n in e){const r=e[n];ot(r)&&ot(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function Kr(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function Xe(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function qt(t){var e,n;et(t,"null loader"),et(Xe(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const qr=()=>{const t=Jt();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function Zr(){return qr()}const ei=new We({id:"loaders.gl"}),ti=/\.([^.]+)$/;async function ni(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!Zt(t))return null;let i=gt(t,e,{...n,nothrow:!0},r);if(i)return i;if(K(t)&&(t=await t.slice(0,10).arrayBuffer(),i=gt(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(en(t));return i}function gt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!Zt(t))return null;if(e&&!Array.isArray(e))return qt(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...Zr()),ii(i);const o=ri(t,i,n,r);if(!o&&!(n!=null&&n.nothrow))throw new Error(en(t));return o}function ri(t,e,n,r){const{url:i,type:o}=Se(t),s=i||(r==null?void 0:r.url);let l=null,c="";if(n!=null&&n.mimeType&&(l=Fe(e,n==null?void 0:n.mimeType),c="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),l=l||oi(e,s),c=c||(l?"matched url ".concat(s):""),l=l||Fe(e,o),c=c||(l?"matched MIME type ".concat(o):""),l=l||ai(e,t),c=c||(l?"matched initial data ".concat(tn(t)):""),l=l||Fe(e,n==null?void 0:n.fallbackMimeType),c=c||(l?"matched fallback MIME type ".concat(o):""),c){var m;ei.log(1,"selectLoader selected ".concat((m=l)===null||m===void 0?void 0:m.name,": ").concat(c,"."))}return l}function Zt(t){return!(t instanceof Response&&t.status===204)}function en(t){const{url:e,type:n}=Se(t);let r="No valid loader found (";r+=e?"".concat(pr(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?tn(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function ii(t){for(const e of t)qt(e)}function oi(t,e){const n=e&&ti.exec(e),r=n&&n[1];return r?si(t,r):null}function si(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function Fe(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function ai(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(li(e,n))return n}else if(ArrayBuffer.isView(e)){if(pt(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&pt(e,0,n))return n;return null}function li(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function pt(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>ui(t,e,n,i))}function ui(t,e,n,r){if(r instanceof ArrayBuffer)return cr(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=Pe(t,e,r.length);return r===i;default:return!1}}function tn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?Pe(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Pe(t,0,e):""}function Pe(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}const ci=256*1024;function*di(t,e){const n=(e==null?void 0:e.chunkSize)||ci;let r=0;const i=new TextEncoder;for(;r<t.length;){const o=Math.min(t.length-r,n),s=t.slice(r,r+o);r+=o,yield i.encode(s)}}const fi=256*1024;function*hi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{chunkSize:n=fi}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),o=new ArrayBuffer(i),s=new Uint8Array(t,r,i);new Uint8Array(o).set(s),r+=i,yield o}}const mi=1024*1024;async function*gi(t,e){const n=(e==null?void 0:e.chunkSize)||mi;let r=0;for(;r<t.size;){const i=r+n,o=await t.slice(r,i).arrayBuffer();r=i,yield o}}function _t(t,e){return Vt?pi(t,e):_i(t)}async function*pi(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:o,value:s}=await i;if(o)return;yield Gt(s)}}catch{n.releaseLock()}}async function*_i(t,e){for await(const n of t)yield Gt(n)}function bi(t,e){if(typeof t=="string")return di(t,e);if(t instanceof ArrayBuffer)return hi(t,e);if(K(t))return gi(t,e);if(jt(t))return _t(t,e);if(Q(t))return _t(t.body,e);throw new Error("makeIterator")}const nn="Cannot convert supplied data type";function vi(t,e,n){if(e.text&&typeof t=="string")return t;if(yr(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(nn)}async function yi(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return vi(t,e);if(K(t)&&(t=await Wt(t)),Q(t)){const i=t;return await Lr(i),e.binary?await i.arrayBuffer():await i.text()}if(jt(t)&&(t=bi(t,n)),br(t)||vr(t))return fr(t);throw new Error(nn)}function wi(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(n)return n;const r={fetch:Kt(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}function Ei(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function $e(t,e,n,r){D(!r||typeof r=="object"),e&&!Array.isArray(e)&&!Xe(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:i}=Se(t),s=Ei(e,r),l=await ni(t,s,n);return l?(n=$r(n,l,s,i),r=wi({url:i,parse:$e,loaders:s},n,r),await xi(l,t,n,r)):null}async function xi(t,e,n,r){if(sr(t),Q(e)){const i=e,{ok:o,redirected:s,status:l,statusText:c,type:m,url:p}=i,h=Object.fromEntries(i.headers.entries());r.response={headers:h,ok:o,redirected:s,status:l,statusText:c,type:m,url:p}}if(e=await yi(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(ar(t,n))return await lr(t,e,n,r,$e);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw D(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Ai(t,e,n,r){!Array.isArray(e)&&!Xe(e)&&(n=e,e=void 0);const i=Kt(n);let o=t;return typeof t=="string"&&(o=await i(t)),K(t)&&(o=await i(t)),await $e(o,e,n)}var Si=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ti(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rn={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(Si,function(){var n=function(){function r(g){return s.appendChild(g.dom),g}function i(g){for(var _=0;_<s.children.length;_++)s.children[_].style.display=_===g?"block":"none";o=g}var o=0,s=document.createElement("div");s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",function(g){g.preventDefault(),i(++o%s.children.length)},!1);var l=(performance||Date).now(),c=l,m=0,p=r(new n.Panel("FPS","#0ff","#002")),h=r(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var f=r(new n.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:s,addPanel:r,showPanel:i,begin:function(){l=(performance||Date).now()},end:function(){m++;var g=(performance||Date).now();if(h.update(g-l,200),g>c+1e3&&(p.update(1e3*m/(g-c),100),c=g,m=0,f)){var _=performance.memory;f.update(_.usedJSHeapSize/1048576,_.jsHeapSizeLimit/1048576)}return g},update:function(){l=this.end()},domElement:s,setMode:i}};return n.Panel=function(r,i,o){var s=1/0,l=0,c=Math.round,m=c(window.devicePixelRatio||1),p=80*m,h=48*m,f=3*m,g=2*m,_=3*m,b=15*m,E=74*m,A=30*m,C=document.createElement("canvas");C.width=p,C.height=h,C.style.cssText="width:80px;height:48px";var x=C.getContext("2d");return x.font="bold "+9*m+"px Helvetica,Arial,sans-serif",x.textBaseline="top",x.fillStyle=o,x.fillRect(0,0,p,h),x.fillStyle=i,x.fillText(r,f,g),x.fillRect(_,b,E,A),x.fillStyle=o,x.globalAlpha=.9,x.fillRect(_,b,E,A),{dom:C,update:function(R,I){s=Math.min(s,R),l=Math.max(l,R),x.fillStyle=o,x.globalAlpha=1,x.fillRect(0,0,p,b),x.fillStyle=i,x.fillText(c(R)+" "+r+" ("+c(s)+"-"+c(l)+")",f,g),x.drawImage(C,_+m,b,E-m,A,_,b,E-m,A),x.fillRect(_+E-m,b,m,A),x.fillStyle=o,x.globalAlpha=.9,x.fillRect(_+E-m,b,m,c((1-R/I)*A))}}},n})})(rn);var Ci=rn.exports;const Li=Ti(Ci);function Ri(t){if(t&&!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}}function Y(t,e){var n=t.__state.conversionName.toString(),r=Math.round(t.r),i=Math.round(t.g),o=Math.round(t.b),s=t.a,l=Math.round(t.h),c=t.s.toFixed(1),m=t.v.toFixed(1);if(e||n==="THREE_CHAR_HEX"||n==="SIX_CHAR_HEX"){for(var p=t.hex.toString(16);p.length<6;)p="0"+p;return"#"+p}else{if(n==="CSS_RGB")return"rgb("+r+","+i+","+o+")";if(n==="CSS_RGBA")return"rgba("+r+","+i+","+o+","+s+")";if(n==="HEX")return"0x"+t.hex.toString(16);if(n==="RGB_ARRAY")return"["+r+","+i+","+o+"]";if(n==="RGBA_ARRAY")return"["+r+","+i+","+o+","+s+"]";if(n==="RGB_OBJ")return"{r:"+r+",g:"+i+",b:"+o+"}";if(n==="RGBA_OBJ")return"{r:"+r+",g:"+i+",b:"+o+",a:"+s+"}";if(n==="HSV_OBJ")return"{h:"+l+",s:"+c+",v:"+m+"}";if(n==="HSVA_OBJ")return"{h:"+l+",s:"+c+",v:"+m+",a:"+s+"}"}return"unknown format"}var bt=Array.prototype.forEach,Z=Array.prototype.slice,d={BREAK:{},extend:function(e){return this.each(Z.call(arguments,1),function(n){var r=this.isObject(n)?Object.keys(n):[];r.forEach(function(i){this.isUndefined(n[i])||(e[i]=n[i])}.bind(this))},this),e},defaults:function(e){return this.each(Z.call(arguments,1),function(n){var r=this.isObject(n)?Object.keys(n):[];r.forEach(function(i){this.isUndefined(e[i])&&(e[i]=n[i])}.bind(this))},this),e},compose:function(){var e=Z.call(arguments);return function(){for(var n=Z.call(arguments),r=e.length-1;r>=0;r--)n=[e[r].apply(this,n)];return n[0]}},each:function(e,n,r){if(e){if(bt&&e.forEach&&e.forEach===bt)e.forEach(n,r);else if(e.length===e.length+0){var i=void 0,o=void 0;for(i=0,o=e.length;i<o;i++)if(i in e&&n.call(r,e[i],i)===this.BREAK)return}else for(var s in e)if(n.call(r,e[s],s)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,n,r){var i=void 0;return function(){var o=this,s=arguments;function l(){i=null,r||e.apply(o,s)}var c=r||!i;clearTimeout(i),i=setTimeout(l,n),c&&e.apply(o,s)}},toArray:function(e){return e.toArray?e.toArray():Z.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(t){function e(n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return isNaN(t)}),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},ki=[{litmus:d.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var n=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return n===null?!1:{space:"HEX",hex:parseInt("0x"+n[1].toString()+n[1].toString()+n[2].toString()+n[2].toString()+n[3].toString()+n[3].toString(),0)}},write:Y},SIX_CHAR_HEX:{read:function(e){var n=e.match(/^#([A-F0-9]{6})$/i);return n===null?!1:{space:"HEX",hex:parseInt("0x"+n[1].toString(),0)}},write:Y},CSS_RGB:{read:function(e){var n=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return n===null?!1:{space:"RGB",r:parseFloat(n[1]),g:parseFloat(n[2]),b:parseFloat(n[3])}},write:Y},CSS_RGBA:{read:function(e){var n=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return n===null?!1:{space:"RGB",r:parseFloat(n[1]),g:parseFloat(n[2]),b:parseFloat(n[3]),a:parseFloat(n[4])}},write:Y}}},{litmus:d.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:d.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:d.isObject,conversions:{RGBA_OBJ:{read:function(e){return d.isNumber(e.r)&&d.isNumber(e.g)&&d.isNumber(e.b)&&d.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return d.isNumber(e.r)&&d.isNumber(e.g)&&d.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return d.isNumber(e.h)&&d.isNumber(e.s)&&d.isNumber(e.v)&&d.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return d.isNumber(e.h)&&d.isNumber(e.s)&&d.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],ee=void 0,me=void 0,De=function(){me=!1;var e=arguments.length>1?d.toArray(arguments):arguments[0];return d.each(ki,function(n){if(n.litmus(e))return d.each(n.conversions,function(r,i){if(ee=r.read(e),me===!1&&ee!==!1)return me=ee,ee.conversionName=i,ee.conversion=r,d.BREAK}),d.BREAK}),me},vt=void 0,Ee={hsv_to_rgb:function(e,n,r){var i=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),s=r*(1-n),l=r*(1-o*n),c=r*(1-(1-o)*n),m=[[r,c,s],[l,r,s],[s,r,c],[s,l,r],[c,s,r],[r,s,l]][i];return{r:m[0]*255,g:m[1]*255,b:m[2]*255}},rgb_to_hsv:function(e,n,r){var i=Math.min(e,n,r),o=Math.max(e,n,r),s=o-i,l=void 0,c=void 0;if(o!==0)c=s/o;else return{h:NaN,s:0,v:0};return e===o?l=(n-r)/s:n===o?l=2+(r-e)/s:l=4+(e-n)/s,l/=6,l<0&&(l+=1),{h:l*360,s:c,v:o/255}},rgb_to_hex:function(e,n,r){var i=this.hex_with_component(0,2,e);return i=this.hex_with_component(i,1,n),i=this.hex_with_component(i,0,r),i},component_from_hex:function(e,n){return e>>n*8&255},hex_with_component:function(e,n,r){return r<<(vt=n*8)|e&~(255<<vt)}},Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},F=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),M=function t(e,n,r){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(i===void 0){var o=Object.getPrototypeOf(e);return o===null?void 0:t(o,n,r)}else{if("value"in i)return i.value;var s=i.get;return s===void 0?void 0:s.call(r)}},U=function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},N=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t},L=function(){function t(){if(O(this,t),this.__state=De.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return F(t,[{key:"toString",value:function(){return Y(this)}},{key:"toHexString",value:function(){return Y(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function Ye(t,e,n){Object.defineProperty(t,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(L.recalculateRGB(this,e,n),this.__state[e])},set:function(i){this.__state.space!=="RGB"&&(L.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=i}})}function Je(t,e){Object.defineProperty(t,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(L.recalculateHSV(this),this.__state[e])},set:function(r){this.__state.space!=="HSV"&&(L.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=r}})}L.recalculateRGB=function(t,e,n){if(t.__state.space==="HEX")t.__state[e]=Ee.component_from_hex(t.__state.hex,n);else if(t.__state.space==="HSV")d.extend(t.__state,Ee.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v));else throw new Error("Corrupted color state")};L.recalculateHSV=function(t){var e=Ee.rgb_to_hsv(t.r,t.g,t.b);d.extend(t.__state,{s:e.s,v:e.v}),d.isNaN(e.h)?d.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h};L.COMPONENTS=["r","g","b","h","s","v","hex","a"];Ye(L.prototype,"r",2);Ye(L.prototype,"g",1);Ye(L.prototype,"b",0);Je(L.prototype,"h");Je(L.prototype,"s");Je(L.prototype,"v");Object.defineProperty(L.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(L.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=Ee.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var H=function(){function t(e,n){O(this,t),this.initialValue=e[n],this.domElement=document.createElement("div"),this.object=e,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return F(t,[{key:"onChange",value:function(n){return this.__onChange=n,this}},{key:"onFinishChange",value:function(n){return this.__onFinishChange=n,this}},{key:"setValue",value:function(n){return this.object[this.property]=n,this.__onChange&&this.__onChange.call(this,n),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),t}(),Fi={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},on={};d.each(Fi,function(t,e){d.each(t,function(n){on[n]=e})});var Ii=/(\d+(\.\d+)?)px/;function B(t){if(t==="0"||d.isUndefined(t))return 0;var e=t.match(Ii);return d.isNull(e)?0:parseFloat(e[1])}var u={makeSelectable:function(e,n){e===void 0||e.style===void 0||(e.onselectstart=n?function(){return!1}:function(){},e.style.MozUserSelect=n?"auto":"none",e.style.KhtmlUserSelect=n?"auto":"none",e.unselectable=n?"on":"off")},makeFullscreen:function(e,n,r){var i=r,o=n;d.isUndefined(o)&&(o=!0),d.isUndefined(i)&&(i=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,n,r,i){var o=r||{},s=on[n];if(!s)throw new Error("Event type "+n+" not supported.");var l=document.createEvent(s);switch(s){case"MouseEvents":{var c=o.x||o.clientX||0,m=o.y||o.clientY||0;l.initMouseEvent(n,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,c,m,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var p=l.initKeyboardEvent||l.initKeyEvent;d.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),p(n,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break}default:{l.initEvent(n,o.bubbles||!1,o.cancelable||!0);break}}d.defaults(l,i),e.dispatchEvent(l)},bind:function(e,n,r,i){var o=i||!1;return e.addEventListener?e.addEventListener(n,r,o):e.attachEvent&&e.attachEvent("on"+n,r),u},unbind:function(e,n,r,i){var o=i||!1;return e.removeEventListener?e.removeEventListener(n,r,o):e.detachEvent&&e.detachEvent("on"+n,r),u},addClass:function(e,n){if(e.className===void 0)e.className=n;else if(e.className!==n){var r=e.className.split(/ +/);r.indexOf(n)===-1&&(r.push(n),e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return u},removeClass:function(e,n){if(n)if(e.className===n)e.removeAttribute("class");else{var r=e.className.split(/ +/),i=r.indexOf(n);i!==-1&&(r.splice(i,1),e.className=r.join(" "))}else e.className=void 0;return u},hasClass:function(e,n){return new RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var n=getComputedStyle(e);return B(n["border-left-width"])+B(n["border-right-width"])+B(n["padding-left"])+B(n["padding-right"])+B(n.width)},getHeight:function(e){var n=getComputedStyle(e);return B(n["border-top-width"])+B(n["border-bottom-width"])+B(n["padding-top"])+B(n["padding-bottom"])+B(n.height)},getOffset:function(e){var n=e,r={left:0,top:0};if(n.offsetParent)do r.left+=n.offsetLeft,r.top+=n.offsetTop,n=n.offsetParent;while(n);return r},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},sn=function(t){U(e,t);function e(n,r){O(this,e);var i=N(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r)),o=i;i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox");function s(){o.setValue(!o.__prev)}return u.bind(i.__checkbox,"change",s,!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return F(e,[{key:"setValue",value:function(r){var i=M(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),i}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),M(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(H),Bi=function(t){U(e,t);function e(n,r,i){O(this,e);var o=N(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r)),s=i,l=o;if(o.__select=document.createElement("select"),d.isArray(s)){var c={};d.each(s,function(m){c[m]=m}),s=c}return d.each(s,function(m,p){var h=document.createElement("option");h.innerHTML=p,h.setAttribute("value",m),l.__select.appendChild(h)}),o.updateDisplay(),u.bind(o.__select,"change",function(){var m=this.options[this.selectedIndex].value;l.setValue(m)}),o.domElement.appendChild(o.__select),o}return F(e,[{key:"setValue",value:function(r){var i=M(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),i}},{key:"updateDisplay",value:function(){return u.isActive(this.__select)?this:(this.__select.value=this.getValue(),M(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(H),Pi=function(t){U(e,t);function e(n,r){O(this,e);var i=N(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r)),o=i;function s(){o.setValue(o.__input.value)}function l(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),u.bind(i.__input,"keyup",s),u.bind(i.__input,"change",s),u.bind(i.__input,"blur",l),u.bind(i.__input,"keydown",function(c){c.keyCode===13&&this.blur()}),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return F(e,[{key:"updateDisplay",value:function(){return u.isActive(this.__input)||(this.__input.value=this.getValue()),M(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(H);function yt(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var an=function(t){U(e,t);function e(n,r,i){O(this,e);var o=N(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r)),s=i||{};return o.__min=s.min,o.__max=s.max,o.__step=s.step,d.isUndefined(o.__step)?o.initialValue===0?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=yt(o.__impliedStep),o}return F(e,[{key:"setValue",value:function(r){var i=r;return this.__min!==void 0&&i<this.__min?i=this.__min:this.__max!==void 0&&i>this.__max&&(i=this.__max),this.__step!==void 0&&i%this.__step!==0&&(i=Math.round(i/this.__step)*this.__step),M(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i)}},{key:"min",value:function(r){return this.__min=r,this}},{key:"max",value:function(r){return this.__max=r,this}},{key:"step",value:function(r){return this.__step=r,this.__impliedStep=r,this.__precision=yt(r),this}}]),e}(H);function Di(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var xe=function(t){U(e,t);function e(n,r,i){O(this,e);var o=N(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r,i));o.__truncationSuspended=!1;var s=o,l=void 0;function c(){var _=parseFloat(s.__input.value);d.isNaN(_)||s.setValue(_)}function m(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function p(){m()}function h(_){var b=l-_.clientY;s.setValue(s.getValue()+b*s.__impliedStep),l=_.clientY}function f(){u.unbind(window,"mousemove",h),u.unbind(window,"mouseup",f),m()}function g(_){u.bind(window,"mousemove",h),u.bind(window,"mouseup",f),l=_.clientY}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),u.bind(o.__input,"change",c),u.bind(o.__input,"blur",p),u.bind(o.__input,"mousedown",g),u.bind(o.__input,"keydown",function(_){_.keyCode===13&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,m())}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return F(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():Di(this.getValue(),this.__precision),M(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(an);function wt(t,e,n,r,i){return r+(i-r)*((t-e)/(n-e))}var Me=function(t){U(e,t);function e(n,r,i,o,s){O(this,e);var l=N(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r,{min:i,max:o,step:s})),c=l;l.__background=document.createElement("div"),l.__foreground=document.createElement("div"),u.bind(l.__background,"mousedown",m),u.bind(l.__background,"touchstart",f),u.addClass(l.__background,"slider"),u.addClass(l.__foreground,"slider-fg");function m(b){document.activeElement.blur(),u.bind(window,"mousemove",p),u.bind(window,"mouseup",h),p(b)}function p(b){b.preventDefault();var E=c.__background.getBoundingClientRect();return c.setValue(wt(b.clientX,E.left,E.right,c.__min,c.__max)),!1}function h(){u.unbind(window,"mousemove",p),u.unbind(window,"mouseup",h),c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}function f(b){b.touches.length===1&&(u.bind(window,"touchmove",g),u.bind(window,"touchend",_),g(b))}function g(b){var E=b.touches[0].clientX,A=c.__background.getBoundingClientRect();c.setValue(wt(E,A.left,A.right,c.__min,c.__max))}function _(){u.unbind(window,"touchmove",g),u.unbind(window,"touchend",_),c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}return l.updateDisplay(),l.__background.appendChild(l.__foreground),l.domElement.appendChild(l.__background),l}return F(e,[{key:"updateDisplay",value:function(){var r=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=r*100+"%",M(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(an),ln=function(t){U(e,t);function e(n,r,i){O(this,e);var o=N(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r)),s=o;return o.__button=document.createElement("div"),o.__button.innerHTML=i===void 0?"Fire":i,u.bind(o.__button,"click",function(l){return l.preventDefault(),s.fire(),!1}),u.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return F(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(H),Ue=function(t){U(e,t);function e(n,r){O(this,e);var i=N(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r));i.__color=new L(i.getValue()),i.__temp=new L(0);var o=i;i.domElement=document.createElement("div"),u.makeSelectable(i.domElement,!1),i.__selector=document.createElement("div"),i.__selector.className="selector",i.__saturation_field=document.createElement("div"),i.__saturation_field.className="saturation-field",i.__field_knob=document.createElement("div"),i.__field_knob.className="field-knob",i.__field_knob_border="2px solid ",i.__hue_knob=document.createElement("div"),i.__hue_knob.className="hue-knob",i.__hue_field=document.createElement("div"),i.__hue_field.className="hue-field",i.__input=document.createElement("input"),i.__input.type="text",i.__input_textShadow="0 1px 1px ",u.bind(i.__input,"keydown",function(b){b.keyCode===13&&h.call(this)}),u.bind(i.__input,"blur",h),u.bind(i.__selector,"mousedown",function(){u.addClass(this,"drag").bind(window,"mouseup",function(){u.removeClass(o.__selector,"drag")})}),u.bind(i.__selector,"touchstart",function(){u.addClass(this,"drag").bind(window,"touchend",function(){u.removeClass(o.__selector,"drag")})});var s=document.createElement("div");d.extend(i.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),d.extend(i.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:i.__field_knob_border+(i.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),d.extend(i.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),d.extend(i.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),d.extend(s.style,{width:"100%",height:"100%",background:"none"}),Et(s,"top","rgba(0,0,0,0)","#000"),d.extend(i.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),Ui(i.__hue_field),d.extend(i.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:i.__input_textShadow+"rgba(0,0,0,0.7)"}),u.bind(i.__saturation_field,"mousedown",l),u.bind(i.__saturation_field,"touchstart",l),u.bind(i.__field_knob,"mousedown",l),u.bind(i.__field_knob,"touchstart",l),u.bind(i.__hue_field,"mousedown",c),u.bind(i.__hue_field,"touchstart",c);function l(b){g(b),u.bind(window,"mousemove",g),u.bind(window,"touchmove",g),u.bind(window,"mouseup",m),u.bind(window,"touchend",m)}function c(b){_(b),u.bind(window,"mousemove",_),u.bind(window,"touchmove",_),u.bind(window,"mouseup",p),u.bind(window,"touchend",p)}function m(){u.unbind(window,"mousemove",g),u.unbind(window,"touchmove",g),u.unbind(window,"mouseup",m),u.unbind(window,"touchend",m),f()}function p(){u.unbind(window,"mousemove",_),u.unbind(window,"touchmove",_),u.unbind(window,"mouseup",p),u.unbind(window,"touchend",p),f()}function h(){var b=De(this.value);b!==!1?(o.__color.__state=b,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function f(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}i.__saturation_field.appendChild(s),i.__selector.appendChild(i.__field_knob),i.__selector.appendChild(i.__saturation_field),i.__selector.appendChild(i.__hue_field),i.__hue_field.appendChild(i.__hue_knob),i.domElement.appendChild(i.__input),i.domElement.appendChild(i.__selector),i.updateDisplay();function g(b){b.type.indexOf("touch")===-1&&b.preventDefault();var E=o.__saturation_field.getBoundingClientRect(),A=b.touches&&b.touches[0]||b,C=A.clientX,x=A.clientY,R=(C-E.left)/(E.right-E.left),I=1-(x-E.top)/(E.bottom-E.top);return I>1?I=1:I<0&&(I=0),R>1?R=1:R<0&&(R=0),o.__color.v=I,o.__color.s=R,o.setValue(o.__color.toOriginal()),!1}function _(b){b.type.indexOf("touch")===-1&&b.preventDefault();var E=o.__hue_field.getBoundingClientRect(),A=b.touches&&b.touches[0]||b,C=A.clientY,x=1-(C-E.top)/(E.bottom-E.top);return x>1?x=1:x<0&&(x=0),o.__color.h=x*360,o.setValue(o.__color.toOriginal()),!1}return i}return F(e,[{key:"updateDisplay",value:function(){var r=De(this.getValue());if(r!==!1){var i=!1;d.each(L.COMPONENTS,function(l){if(!d.isUndefined(r[l])&&!d.isUndefined(this.__color.__state[l])&&r[l]!==this.__color.__state[l])return i=!0,{}},this),i&&d.extend(this.__color.__state,r)}d.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0,s=255-o;d.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,Et(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),d.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}}]),e}(H),Mi=["-moz-","-o-","-webkit-","-ms-",""];function Et(t,e,n,r){t.style.background="",d.each(Mi,function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+r+" 100%); "})}function Ui(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var Ni={load:function(e,n){var r=n||document,i=r.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,r.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,n){var r=n||document,i=document.createElement("style");i.type="text/css",i.innerHTML=e;var o=r.getElementsByTagName("head")[0];try{o.appendChild(i)}catch{}}},Vi=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,zi=function(e,n){var r=e[n];return d.isArray(arguments[2])||d.isObject(arguments[2])?new Bi(e,n,arguments[2]):d.isNumber(r)?d.isNumber(arguments[2])&&d.isNumber(arguments[3])?d.isNumber(arguments[4])?new Me(e,n,arguments[2],arguments[3],arguments[4]):new Me(e,n,arguments[2],arguments[3]):d.isNumber(arguments[4])?new xe(e,n,{min:arguments[2],max:arguments[3],step:arguments[4]}):new xe(e,n,{min:arguments[2],max:arguments[3]}):d.isString(r)?new Pi(e,n):d.isFunction(r)?new ln(e,n,""):d.isBoolean(r)?new sn(e,n):null};function Hi(t){setTimeout(t,1e3/60)}var Gi=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||Hi,ji=function(){function t(){O(this,t),this.backgroundElement=document.createElement("div"),d.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),u.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),d.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;u.bind(this.backgroundElement,"click",function(){e.hide()})}return F(t,[{key:"show",value:function(){var n=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),d.defer(function(){n.backgroundElement.style.opacity=1,n.domElement.style.opacity=1,n.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var n=this,r=function i(){n.domElement.style.display="none",n.backgroundElement.style.display="none",u.unbind(n.domElement,"webkitTransitionEnd",i),u.unbind(n.domElement,"transitionend",i),u.unbind(n.domElement,"oTransitionEnd",i)};u.bind(this.domElement,"webkitTransitionEnd",r),u.bind(this.domElement,"transitionend",r),u.bind(this.domElement,"oTransitionEnd",r),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-u.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-u.getHeight(this.domElement)/2+"px"}}]),t}(),Wi=Ri(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);Ni.inject(Wi);var xt="dg",At=72,St=20,ce="Default",ne=function(){try{return!!window.localStorage}catch{return!1}}(),oe=void 0,Tt=!0,W=void 0,Ie=!1,un=[],S=function t(e){var n=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),u.addClass(this.domElement,xt),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=d.defaults(r,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),r=d.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),d.isUndefined(r.load)?r.load={preset:ce}:r.preset&&(r.load.preset=r.preset),d.isUndefined(r.parent)&&r.hideable&&un.push(this),r.resizable=d.isUndefined(r.parent)&&r.resizable,r.autoPlace&&d.isUndefined(r.scrollable)&&(r.scrollable=!0);var i=ne&&localStorage.getItem(X(this,"isLocal"))==="true",o=void 0,s=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:r.load.preset},set:function(f){n.parent?n.getRoot().preset=f:r.load.preset=f,Ji(this),n.revert()}},width:{get:function(){return r.width},set:function(f){r.width=f,ze(n,f)}},name:{get:function(){return r.name},set:function(f){r.name=f,s&&(s.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(f){r.closed=f,r.closed?u.addClass(n.__ul,t.CLASS_CLOSED):u.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=f?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return i},set:function(f){ne&&(i=f,f?u.bind(window,"unload",o):u.unbind(window,"unload",o),localStorage.setItem(X(n,"isLocal"),f))}}}),d.isUndefined(r.parent)){if(this.closed=r.closed||!1,u.addClass(this.domElement,t.CLASS_MAIN),u.makeSelectable(this.domElement,!1),ne&&i){n.useLocalStorage=!0;var l=localStorage.getItem(X(this,"gui"));l&&(r.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,u.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),r.closeOnTop?(u.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(u.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),u.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{r.closed===void 0&&(r.closed=!0);var c=document.createTextNode(r.name);u.addClass(c,"controller-name"),s=Qe(n,c);var m=function(f){return f.preventDefault(),n.closed=!n.closed,!1};u.addClass(this.__ul,t.CLASS_CLOSED),u.addClass(s,"title"),u.bind(s,"click",m),r.closed||(this.closed=!1)}r.autoPlace&&(d.isUndefined(r.parent)&&(Tt&&(W=document.createElement("div"),u.addClass(W,xt),u.addClass(W,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(W),Tt=!1),W.appendChild(this.domElement),u.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||ze(n,r.width)),this.__resizeHandler=function(){n.onResizeDebounced()},u.bind(window,"resize",this.__resizeHandler),u.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),u.bind(this.__ul,"transitionend",this.__resizeHandler),u.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&Yi(this),o=function(){ne&&localStorage.getItem(X(n,"isLocal"))==="true"&&localStorage.setItem(X(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=o;function p(){var h=n.getRoot();h.width+=1,d.defer(function(){h.width-=1})}r.parent||p()};S.toggleHide=function(){Ie=!Ie,d.each(un,function(t){t.domElement.style.display=Ie?"none":""})};S.CLASS_AUTO_PLACE="a";S.CLASS_AUTO_PLACE_CONTAINER="ac";S.CLASS_MAIN="main";S.CLASS_CONTROLLER_ROW="cr";S.CLASS_TOO_TALL="taller-than-window";S.CLASS_CLOSED="closed";S.CLASS_CLOSE_BUTTON="close-button";S.CLASS_CLOSE_TOP="close-top";S.CLASS_CLOSE_BOTTOM="close-bottom";S.CLASS_DRAG="drag";S.DEFAULT_WIDTH=245;S.TEXT_CLOSED="Close Controls";S.TEXT_OPEN="Open Controls";S._keydownHandler=function(t){document.activeElement.type!=="text"&&(t.which===At||t.keyCode===At)&&S.toggleHide()};u.bind(window,"keydown",S._keydownHandler,!1);d.extend(S.prototype,{add:function(e,n){return se(this,e,n,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,n){return se(this,e,n,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var n=this;d.defer(function(){n.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&W.removeChild(this.domElement);var e=this;d.each(this.__folders,function(n){e.removeFolder(n)}),u.unbind(window,"keydown",S._keydownHandler,!1),Ct(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var n={name:e,parent:this};n.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(n.closed=this.load.folders[e].closed,n.load=this.load.folders[e]);var r=new S(n);this.__folders[e]=r;var i=Qe(this,r.domElement);return u.addClass(i,"folder"),r},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],Ct(e);var n=this;d.each(e.__folders,function(r){e.removeFolder(r)}),d.defer(function(){n.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var n=u.getOffset(e.__ul).top,r=0;d.each(e.__ul.childNodes,function(i){e.autoPlace&&i===e.__save_row||(r+=u.getHeight(i))}),window.innerHeight-n-St<r?(u.addClass(e.domElement,S.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-n-St+"px"):(u.removeClass(e.domElement,S.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&d.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:d.debounce(function(){this.onResize()},50),remember:function(){if(d.isUndefined(oe)&&(oe=new ji,oe.domElement.innerHTML=Vi),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;d.each(Array.prototype.slice.call(arguments),function(n){e.__rememberedObjects.length===0&&$i(e),e.__rememberedObjects.indexOf(n)===-1&&e.__rememberedObjects.push(n)}),this.autoPlace&&ze(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=ge(this)),e.folders={},d.each(this.__folders,function(n,r){e.folders[r]=n.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=ge(this),Ne(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[ce]=ge(this,!0)),this.load.remembered[e]=ge(this),this.preset=e,Ve(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){d.each(this.__controllers,function(n){this.getRoot().load.remembered?cn(e||this.getRoot(),n):n.setValue(n.initialValue),n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())},this),d.each(this.__folders,function(n){n.revert(n)}),e||Ne(this.getRoot(),!1)},listen:function(e){var n=this.__listening.length===0;this.__listening.push(e),n&&dn(this.__listening)},updateDisplay:function(){d.each(this.__controllers,function(e){e.updateDisplay()}),d.each(this.__folders,function(e){e.updateDisplay()})}});function Qe(t,e,n){var r=document.createElement("li");return e&&r.appendChild(e),n?t.__ul.insertBefore(r,n):t.__ul.appendChild(r),t.onResize(),r}function Ct(t){u.unbind(window,"resize",t.__resizeHandler),t.saveToLocalStorageIfPossible&&u.unbind(window,"unload",t.saveToLocalStorageIfPossible)}function Ne(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];e?n.innerHTML=n.value+"*":n.innerHTML=n.value}function Xi(t,e,n){if(n.__li=e,n.__gui=t,d.extend(n,{options:function(s){if(arguments.length>1){var l=n.__li.nextElementSibling;return n.remove(),se(t,n.object,n.property,{before:l,factoryArgs:[d.toArray(arguments)]})}if(d.isArray(s)||d.isObject(s)){var c=n.__li.nextElementSibling;return n.remove(),se(t,n.object,n.property,{before:c,factoryArgs:[s]})}},name:function(s){return n.__li.firstElementChild.firstElementChild.innerHTML=s,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof Me){var r=new xe(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});d.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(o){var s=n[o],l=r[o];n[o]=r[o]=function(){var c=Array.prototype.slice.call(arguments);return l.apply(r,c),s.apply(n,c)}}),u.addClass(e,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof xe){var i=function(s){if(d.isNumber(n.__min)&&d.isNumber(n.__max)){var l=n.__li.firstElementChild.firstElementChild.innerHTML,c=n.__gui.__listening.indexOf(n)>-1;n.remove();var m=se(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return m.name(l),c&&m.listen(),m}return s};n.min=d.compose(i,n.min),n.max=d.compose(i,n.max)}else n instanceof sn?(u.bind(e,"click",function(){u.fakeEvent(n.__checkbox,"click")}),u.bind(n.__checkbox,"click",function(o){o.stopPropagation()})):n instanceof ln?(u.bind(e,"click",function(){u.fakeEvent(n.__button,"click")}),u.bind(e,"mouseover",function(){u.addClass(n.__button,"hover")}),u.bind(e,"mouseout",function(){u.removeClass(n.__button,"hover")})):n instanceof Ue&&(u.addClass(e,"color"),n.updateDisplay=d.compose(function(o){return e.style.borderLeftColor=n.__color.toString(),o},n.updateDisplay),n.updateDisplay());n.setValue=d.compose(function(o){return t.getRoot().__preset_select&&n.isModified()&&Ne(t.getRoot(),!0),o},n.setValue)}function cn(t,e){var n=t.getRoot(),r=n.__rememberedObjects.indexOf(e.object);if(r!==-1){var i=n.__rememberedObjectIndecesToControllers[r];if(i===void 0&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,n.load&&n.load.remembered){var o=n.load.remembered,s=void 0;if(o[t.preset])s=o[t.preset];else if(o[ce])s=o[ce];else return;if(s[r]&&s[r][e.property]!==void 0){var l=s[r][e.property];e.initialValue=l,e.setValue(l)}}}}function se(t,e,n,r){if(e[n]===void 0)throw new Error('Object "'+e+'" has no property "'+n+'"');var i=void 0;if(r.color)i=new Ue(e,n);else{var o=[e,n].concat(r.factoryArgs);i=zi.apply(t,o)}r.before instanceof H&&(r.before=r.before.__li),cn(t,i),u.addClass(i.domElement,"c");var s=document.createElement("span");u.addClass(s,"property-name"),s.innerHTML=i.property;var l=document.createElement("div");l.appendChild(s),l.appendChild(i.domElement);var c=Qe(t,l,r.before);return u.addClass(c,S.CLASS_CONTROLLER_ROW),i instanceof Ue?u.addClass(c,"color"):u.addClass(c,Oi(i.getValue())),Xi(t,c,i),t.__controllers.push(i),i}function X(t,e){return document.location.href+"."+e}function Ve(t,e,n){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function Lt(t,e){e.style.display=t.useLocalStorage?"block":"none"}function $i(t){var e=t.__save_row=document.createElement("li");u.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),u.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",u.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",u.addClass(r,"button"),u.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",u.addClass(i,"button"),u.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",u.addClass(o,"button"),u.addClass(o,"revert");var s=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?d.each(t.load.remembered,function(h,f){Ve(t,f,f===t.preset)}):Ve(t,ce,!1),u.bind(s,"change",function(){for(var h=0;h<t.__preset_select.length;h++)t.__preset_select[h].innerHTML=t.__preset_select[h].value;t.preset=this.value}),e.appendChild(s),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(o),ne){var l=document.getElementById("dg-local-explain"),c=document.getElementById("dg-local-storage"),m=document.getElementById("dg-save-locally");m.style.display="block",localStorage.getItem(X(t,"isLocal"))==="true"&&c.setAttribute("checked","checked"),Lt(t,l),u.bind(c,"change",function(){t.useLocalStorage=!t.useLocalStorage,Lt(t,l)})}var p=document.getElementById("dg-new-constructor");u.bind(p,"keydown",function(h){h.metaKey&&(h.which===67||h.keyCode===67)&&oe.hide()}),u.bind(n,"click",function(){p.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),oe.show(),p.focus(),p.select()}),u.bind(r,"click",function(){t.save()}),u.bind(i,"click",function(){var h=prompt("Enter a new preset name.");h&&t.saveAs(h)}),u.bind(o,"click",function(){t.revert()})}function Yi(t){var e=void 0;t.__resize_handle=document.createElement("div"),d.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function n(o){return o.preventDefault(),t.width+=e-o.clientX,t.onResize(),e=o.clientX,!1}function r(){u.removeClass(t.__closeButton,S.CLASS_DRAG),u.unbind(window,"mousemove",n),u.unbind(window,"mouseup",r)}function i(o){return o.preventDefault(),e=o.clientX,u.addClass(t.__closeButton,S.CLASS_DRAG),u.bind(window,"mousemove",n),u.bind(window,"mouseup",r),!1}u.bind(t.__resize_handle,"mousedown",i),u.bind(t.__closeButton,"mousedown",i),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function ze(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function ge(t,e){var n={};return d.each(t.__rememberedObjects,function(r,i){var o={},s=t.__rememberedObjectIndecesToControllers[i];d.each(s,function(l,c){o[c]=e?l.initialValue:l.getValue()}),n[i]=o}),n}function Ji(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}function dn(t){t.length!==0&&Gi.call(window,function(){dn(t)}),d.each(t,function(e){e.updateDisplay()})}var Qi=S;const Ki=`#version 300 es
  
  layout (location = 0) in vec2 quadVertexModelPosition;
  
  void main() {
    gl_Position = vec4(quadVertexModelPosition, 0., 1.);
  }`,qi=`#version 300 es

  #define M_PI 3.1415926535897932384626433832795

  precision mediump float;
  
  //.xy: asteroid's position vector
  layout (location = 0) out vec4 asteroidData;

  uniform int   textureDimension;
  uniform int   asteroidCount;
  uniform float elapsedTime;
  uniform float radius;
  uniform float minRadius;

  //! [https://graphtoy.com/?f1(x,t)=fract(x%20*%20.1031)&v1=false&f2(x,t)=f1(x)%20*%20(f1(x)%20+%2033.33)&v2=false&f3(x,t)=f2(x)%20*%20(f2(x)%20+%20f2(x))&v3=false&f4(x,t)=fract(f3(x))&v4=true&f5(x,t)=&v5=false&f6(x,t)=&v6=false&grid=1&coords=0.2431201500521052,0.41137848291959966,0.6251842178309247]
  //! [https://www.shadertoy.com/view/4djSRW]
  float hash11(float p)
  {
    p = fract(p * .1031);
    p *= p + 33.33;
    p *= p + p;
    return fract(p);
  }

  int calculateIndex()
  {
    ivec2 fragCoord = ivec2(gl_FragCoord.xy);
    return fragCoord.y * textureDimension + fragCoord.x;
  }

  void main() {

    int index = calculateIndex();

    if (index < asteroidCount &&
        //asteroidCount <= textureDimension * textureDimension)
        index < textureDimension * textureDimension)
    {
      // float hash0 = hash11( float(index) + hash11(float(index)) );
      float hash0 = hash11( float(index) );
      float hash1 = hash11( float(index) + hash0 );
      float theta = hash0 * 2. * M_PI + elapsedTime * 0.1;
      asteroidData.xy = (minRadius + float(int((hash1 * radius) / 0.6)) * 0.6) * vec2(cos(theta), sin(theta));

      float hash2 = hash11(float(index) + hash1);
      float hash3 = hash11(float(index) + hash2);
      asteroidData.zw = vec2(hash2, hash3);
    }

  }`,Zi=`#version 300 es

  layout (location = 0) in vec3 vertexModelPosition;
  layout (location = 1) in vec2 vertexUV;

  uniform sampler2D asteroidData;
  uniform mat4 wtoc;
  uniform mat4 ctoc;
  uniform float elapsedTime;

  out vec2 fragmentUV;

  ivec2 calculateIndex()
  {
    int textureDimension = textureSize(asteroidData, 0).x;
    ivec2 index = ivec2(0);
    
    index.x = gl_InstanceID % textureDimension;
    index.y = gl_InstanceID / textureDimension;

    return index;
  }

  void main() {

    fragmentUV = vertexUV;

    ivec2 index = calculateIndex();
    vec4 data = texelFetch(asteroidData, index, 0).xyzw;

    vec3 u = vec3(
      data.z, data.w, 
      sqrt(1. - ( data.z * data.z + data.w * data.w ))
    );
    
    float ct = cos(elapsedTime);
    float st = sin(elapsedTime);

    mat4 mtow = mat4(

      ct + u.x * u.x * (1. - ct), 
      u.x * u.y * (1. - ct) - u.z * st, 
      u.x * u.z * (1. - ct) + u.y * st, 
      data.x,

      u.y * u.x * (1. - ct) + u.z * st,
      ct + u.y * u.y * (1. - ct),
      u.y * u.z * (1. - ct) - u.x * st, 
      0.,

      u.z * u.x * (1. - ct) - u.y * st,
      u.z * u.y * (1. - ct) + u.x * st,
      ct + u.z * u.z * (1. - ct),
      data.y,

      0., 0., 0., 1.

    );
    mtow = transpose(mtow);

    gl_Position = ctoc * wtoc * mtow * vec4(vertexModelPosition, 1.);

  }`,eo=`#version 300 es

  precision mediump float;
  
  uniform sampler2D diffuseTexture;

  in vec2 fragmentUV;

  out vec4 outputColor;

  void main() {

    vec3 diffuse = texture(diffuseTexture, fragmentUV).rgb;
    outputColor = vec4(diffuse, 1.);
    
  }`;let ae,te,a,Rt,to=gn(90),no=.001,ro=1e3,io=He(0,5,15),kt=It(),Ot=It(),V=100,be=1,ve=10,y={vertexShader:null,fragmentShader:null,program:null,VAO:null,BO0:null,BO1:null,texture:null,vertexCount:null,wtocLoc:null,ctocLoc:null,asteroidDataLoc:null,elapsedTimeLoc:null,diffuseTextureLoc:null},w={vertexShader:null,fragmentShader:null,program:null,fbo:null,attachment0:null,attachment1:null,textureDimension:256,minRadiusLoc:null,textureDimensionLoc:null,asteroidCountLoc:null,elapsedTimeLoc:null,radiusLoc:null};const oo=new Float32Array([1,-1,-1,-1,-1,1,1,-1,-1,1,1,1]);let z={VAO:null,BO0:null};function Ft(){a.canvas.width=a.canvas.clientWidth,a.canvas.height=a.canvas.clientHeight,Rt=a.canvas.width/a.canvas.height;//! lookAt(out, eye, center, up) → {mat4}
vn(kt,io,Bt(),He(0,1,0));//! perspective(out, fovy, aspect, near, far) → {mat4}
bn(Ot,to,Rt,no,ro),a.useProgram(y.program),a.uniformMatrix4fv(y.wtocLoc,!1,kt),a.uniformMatrix4fv(y.ctocLoc,!1,Ot),a.useProgram(null),a.viewport(0,0,a.canvas.width,a.canvas.height)}function so(){z.VAO=a.createVertexArray(),a.bindVertexArray(z.VAO),z.BO0=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,z.BO0),a.bufferData(a.ARRAY_BUFFER,oo,a.STATIC_DRAW),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,null),a.bindVertexArray(null),console.log("initScreenQuad")}function ao(){switch(a.checkFramebufferStatus(a.FRAMEBUFFER)){case a.FRAMEBUFFER_COMPLETE:console.log("Framebuffer is complete");break;case a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.error("Framebuffer incomplete attachment");break;case a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.error("Framebuffer incomplete missing attachment");break;case a.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:console.error("Framebuffer incomplete multisample");break;case a.FRAMEBUFFER_UNSUPPORTED:console.error("Framebuffer unsupported");break;default:console.error("Unknown framebuffer status");break}}function lo(){w.fbo=a.createFramebuffer(),a.bindFramebuffer(a.FRAMEBUFFER,w.fbo),w.attachment0=a.createTexture(),a.bindTexture(a.TEXTURE_2D,w.attachment0),a.texImage2D(a.TEXTURE_2D,0,a.RGBA32F,w.textureDimension,w.textureDimension,0,a.RGBA,a.FLOAT,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,w.attachment0,0),a.drawBuffers([a.COLOR_ATTACHMENT0]),ao(),a.bindFramebuffer(a.FRAMEBUFFER,null),a.bindTexture(a.TEXTURE_2D,null),w.vertexShader=Ae(a,Ki,a.VERTEX_SHADER),w.fragmentShader=Ae(a,qi,a.FRAGMENT_SHADER),w.program=fn(a,w.vertexShader,w.fragmentShader),w.textureDimensionLoc=a.getUniformLocation(w.program,"textureDimension"),w.asteroidCountLoc=a.getUniformLocation(w.program,"asteroidCount"),w.elapsedTimeLoc=a.getUniformLocation(w.program,"elapsedTime"),w.radiusLoc=a.getUniformLocation(w.program,"radius"),w.minRadiusLoc=a.getUniformLocation(w.program,"minRadius"),a.useProgram(w.program),a.uniform1i(w.textureDimensionLoc,w.textureDimension),a.uniform1i(w.asteroidCountLoc,V),a.uniform1f(w.radiusLoc,ve),a.uniform1f(w.minRadiusLoc,be),a.useProgram(null),console.log("initGPGPUPass")}function uo(t){a.bindFramebuffer(a.FRAMEBUFFER,w.fbo),a.useProgram(w.program),a.uniform1f(w.elapsedTimeLoc,t),a.bindVertexArray(z.VAO),a.drawArrays(a.TRIANGLES,0,6),a.bindVertexArray(null),a.useProgram(null),a.bindFramebuffer(a.FRAMEBUFFER,null)}async function co(){y.vertexShader=Ae(a,Zi,a.VERTEX_SHADER),y.fragmentShader=Ae(a,eo,a.FRAGMENT_SHADER),y.program=fn(a,y.vertexShader,y.fragmentShader),y.wtocLoc=a.getUniformLocation(y.program,"wtoc"),y.ctocLoc=a.getUniformLocation(y.program,"ctoc"),y.asteroidDataLoc=a.getUniformLocation(y.program,"asteroidData"),y.diffuseTextureLoc=a.getUniformLocation(y.program,"diffuseTexture"),y.elapsedTimeLoc=a.getUniformLocation(y.program,"elapsedTime"),a.useProgram(y.program);//! No wtoc & ctoc uniforms are set here.
a.useProgram(null),console.log("initInstancedDrawingPass");//! [https://webgl2fundamentals.org/webgl/lessons/webgl-3d-textures.html]
await new Promise((i,o)=>{var s=new Image;s.addEventListener("load",()=>{y.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,y.texture),a.texImage2D(a.TEXTURE_2D,0,a.RGB,s.width,s.height,0,a.RGB,a.UNSIGNED_BYTE,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_2D,null),a.useProgram(y.program),a.activeTexture(a.TEXTURE0+0),a.bindTexture(a.TEXTURE_2D,w.attachment0),a.uniform1i(y.asteroidDataLoc,0),a.activeTexture(a.TEXTURE0+1),a.bindTexture(a.TEXTURE_2D,y.texture),a.uniform1i(y.diffuseTextureLoc,1),a.useProgram(null),console.log("Image"),i()}),s.onerror=o,s.src="./rock_Base_Color.png"});//! [https://loaders.gl/docs/modules/obj/api-reference/obj-loader]
const t=await Ai("./rock_by_dommk.obj",Jn);let e=t.attributes.POSITION.value;const n=t.header.boundingBox;let r=He(n[1][0]-n[0][0],n[1][1]-n[0][1],n[1][2]-n[0][2]);r=wn(r),r=1/r;for(let i=0;i<e.length;i++)e[i]*=r;y.VAO=a.createVertexArray(),a.bindVertexArray(y.VAO),y.vertexCount=t.header.vertexCount,y.BO0=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,y.BO0),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),y.BO1=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,y.BO1),a.bufferData(a.ARRAY_BUFFER,t.attributes.TEXCOORD_0.value,a.STATIC_DRAW),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,null),a.bindVertexArray(null),console.log("meshMetadata")}function fo(t){a.useProgram(y.program),a.uniform1f(y.elapsedTimeLoc,t),a.bindVertexArray(y.VAO),a.drawArraysInstanced(a.TRIANGLES,0,y.vertexCount,V),a.bindVertexArray(null),a.useProgram(null)}function ho(){let t=document.createElement("canvas");t.setAttribute("id","canvas1"),document.body.appendChild(t),t=document.getElementById("canvas1");//! [https://www.khronos.org/webgl/wiki/Debugging]
if(a=t.getContext("webgl2"),!a){alert("WebGL 2 is not supported");return}//! Spector.js enables "EXT_color_buffer_float" by default, and having it on for a while and going back to vanilla confused me a bit, since the framebuffer status was dirty all of a sudden.
if(!a.getExtension("EXT_color_buffer_float")){console.error('"EXT_color_buffer_float" extension is not enabled');return}//! [https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL]
a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0),a.enable(a.DEPTH_TEST),a.enable(a.CULL_FACE),a.cullFace(a.BACK),ae=new Li,ae.showPanel(0),document.body.appendChild(ae.dom),window.addEventListener("beforeunload",()=>{a.deleteProgram(y.program),a.deleteShader(y.vertexShader),a.deleteShader(y.fragmentShader),a.deleteVertexArray(y.VAO),a.deleteBuffer(y.BO0),a.deleteBuffer(y.BO1),a.deleteBuffer(y.texture),a.deleteProgram(w.program),a.deleteShader(w.vertexShader),a.deleteShader(w.fragmentShader),a.deleteFramebuffer(w.fbo),a.deleteTexture(w.attachment0),a.deleteVertexArray(z.VAO),a.deleteBuffer(z.BO0)}),window.addEventListener("resize",Ft),so(),lo(),co().then(()=>{Ft(),te=new Qi;let n={"Asteroid Count":V,"Triangle Count":y.vertexCount/3*V,"Min Radius":be,"Field Width":ve},r=te.add(n,"Triangle Count").listen();//! [https://stackoverflow.com/questions/38602189/how-to-lock-slider-and-prevent-updating-of-values-with-mouse-into-dat-gui-menu]
r.domElement.style.pointerEvents="none",r.domElement.parentElement.style.pointerEvents="none",te.add(n,"Asteroid Count").min(100).max(5e4).step(1).onChange(i=>{V=i,n["Triangle Count"]=y.vertexCount/3*V,a.useProgram(w.program),a.uniform1i(w.asteroidCountLoc,V),a.useProgram(null)}),te.add(n,"Min Radius").min(1).max(100).step(1).onChange(i=>{be=i,a.useProgram(w.program),a.uniform1f(w.minRadiusLoc,be),a.useProgram(null)}),te.add(n,"Field Width").min(1).max(100).step(1).onChange(i=>{ve=i,a.useProgram(w.program),a.uniform1f(w.radiusLoc,ve),a.useProgram(null)}),console.log("GUI")}),a.clearColor(0,0,0,1)}//! [https://webgl2fundamentals.org/webgl/lessons/webgl-boilerplate.html]
function Ae(t,e,n){let r=t.createShader(n);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw"could not compile shader:"+t.getShaderInfoLog(r);return r}//! [https://webgl2fundamentals.org/webgl/lessons/webgl-boilerplate.html]
function fn(t,e,n){let r=t.createProgram();if(t.attachShader(r,e),t.attachShader(r,n),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw"program failed to link:"+t.getProgramInfoLog(r);return r}function hn(t){let e=t*.001;ae.begin(),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);//! The first GPGPU pass has its quad's vertices defined in clock-wise order.
//! Change it to gl.CCW, to see interestingly we can still be able to see one asteroid; we'll still be able to see one if we skip the first GPGPU pass ;)
a.frontFace(a.CW),uo(e),a.frontFace(a.CCW),fo(e),ae.end(),requestAnimationFrame(hn)}ho();hn();
